# .env
# migrations/env.py

from logging.config import fileConfig
from sqlalchemy import engine_from_config, pool
from alembic import context
import os
import sys

# ---------------------------------------------------------
# 1) Add project root so 'app' becomes importable
# ---------------------------------------------------------
BASE_DIR = os.path.abspath(os.path.join(os.path.dirname(__file__), ".."))
sys.path.insert(0, BASE_DIR)

# ---------------------------------------------------------
# 2) Import models + settings
# ---------------------------------------------------------
try:
    from app.models import Base
except Exception as e:
    print("IMPORT ERROR:", e)
    print("sys.path:", sys.path)
    raise

from app.main import DATABASE_URL

# Blockflow Exchange Environment Variables

ENV=production
DEMO_MODE=true
DEBUG=false

# Database (Render connection string)
DATABASE_URL=postgresql://blockflowv2_db_user:ugCjWRmTL1yGEuby5DwfTdMQ72vgbn50@dpg-d4afm1ili9vc73fh9o5g-a/blockflowv2_db

# JWT
JWT_SECRET=supersecretkeychangeinproduction1234567890
JWT_ALGORITHM=HS256
JWT_EXPIRY_MINUTES=60

# CORS (Render + localhost)
ALLOWED_ORIGINS=["https://blockflow.onrender.com","http://localhost:3000"]

# Pooling
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40

# TDS & Fees
TDS_RATE=0.01
TDS_THRESHOLD_INDIVIDUAL=50000
TDS_THRESHOLD_BUSINESS=10000
MAKER_FEE=0.0004
TAKER_FEE=0.001

# Port
PORT=8000
